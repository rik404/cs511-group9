SQL1:
    select
        l_returnflag,
        l_linestatus,
        sum(l_quantity) as sum_qty,
        sum(l_extendedprice) as sum_base_price,
        sum(l_extendedprice * (1-l_discount)) as sum_disc_price,
        sum(l_extendedprice * (1-l_discount) * (1+l_tax)) as sum_charge,
        avg(l_quantity) as avg_qty,
        avg(l_extendedprice) as avg_price,
        avg(l_discount) as avg_disc,
        count(*) as count_order
    from
        lineitem
    where
        l_shipdate <= mdy (12, 01, 1998 ) - 90 units day
    group by
        l_returnflag,
        l_linestatus
    order by
        l_returnflag,
        l_linestatus;

ARANGO 1:
LET cutoffDate = DATE_SUBTRACT(DATE_ISO8601("1998-12-01"), 90, "day")

LET result = (
    FOR doc IN sample2
        FILTER doc.shipdate <= cutoffDate
        COLLECT AGGREGATE
            sum_qty = SUM(doc.quantity),
            sum_base_price = SUM(doc.extendedPrice),
            sum_disc_price = SUM(doc.extendedPrice * (1 - doc.discount)),
            sum_charge = SUM(doc.extendedPrice * (1 - doc.discount) * (1 + doc.tax)),
            avg_qty = AVG(doc.quantity),
            avg_price = AVG(doc.extendedPrice),
            avg_disc = AVG(doc.discount),
            count_order = COUNT()
    RETURN {
        sum_qty: sum_qty,
        sum_base_price: sum_base_price,
        sum_disc_price: sum_disc_price,
        sum_charge: sum_charge,
        avg_qty: avg_qty,
        avg_price: avg_price,
        avg_disc: avg_disc,
        count_order: count_order
    }
)

RETURN result[0]

